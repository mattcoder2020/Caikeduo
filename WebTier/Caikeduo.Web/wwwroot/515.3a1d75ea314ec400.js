"use strict";(self.webpackChunkAccessManagment=self.webpackChunkAccessManagment||[]).push([[515],{1515:(ne,f,o)=>{o.r(f),o.d(f,{DEFAULT_TENANT_MANAGEMENT_CREATE_FORM_PROPS:()=>I,DEFAULT_TENANT_MANAGEMENT_EDIT_FORM_PROPS:()=>D,DEFAULT_TENANT_MANAGEMENT_ENTITY_ACTIONS:()=>S,DEFAULT_TENANT_MANAGEMENT_ENTITY_PROPS:()=>P,DEFAULT_TENANT_MANAGEMENT_TOOLBAR_ACTIONS:()=>F,TENANT_MANAGEMENT_CREATE_FORM_PROP_CONTRIBUTORS:()=>h,TENANT_MANAGEMENT_EDIT_FORM_PROP_CONTRIBUTORS:()=>M,TENANT_MANAGEMENT_ENTITY_ACTION_CONTRIBUTORS:()=>A,TENANT_MANAGEMENT_ENTITY_PROP_CONTRIBUTORS:()=>g,TENANT_MANAGEMENT_TOOLBAR_ACTION_CONTRIBUTORS:()=>_,TenantManagementExtensionsGuard:()=>E,TenantManagementModule:()=>te,TenantsComponent:()=>u});var r=o(6304),e=o(2223);let L=(()=>{class t{constructor(n){this.restService=n,this.apiName="AbpTenantManagement",this.create=a=>this.restService.request({method:"POST",url:"/api/multi-tenancy/tenants",body:a},{apiName:this.apiName}),this.delete=a=>this.restService.request({method:"DELETE",url:`/api/multi-tenancy/tenants/${a}`},{apiName:this.apiName}),this.deleteDefaultConnectionString=a=>this.restService.request({method:"DELETE",url:`/api/multi-tenancy/tenants/${a}/default-connection-string`},{apiName:this.apiName}),this.get=a=>this.restService.request({method:"GET",url:`/api/multi-tenancy/tenants/${a}`},{apiName:this.apiName}),this.getDefaultConnectionString=a=>this.restService.request({method:"GET",responseType:"text",url:`/api/multi-tenancy/tenants/${a}/default-connection-string`},{apiName:this.apiName}),this.getList=a=>this.restService.request({method:"GET",url:"/api/multi-tenancy/tenants",params:{filter:a.filter,sorting:a.sorting,skipCount:a.skipCount,maxResultCount:a.maxResultCount}},{apiName:this.apiName}),this.update=(a,i)=>this.restService.request({method:"PUT",url:`/api/multi-tenancy/tenants/${a}`,body:i},{apiName:this.apiName}),this.updateDefaultConnectionString=(a,i)=>this.restService.request({method:"PUT",url:`/api/multi-tenancy/tenants/${a}/default-connection-string`,params:{defaultConnectionString:i}},{apiName:this.apiName})}static#e=this.\u0275fac=function(a){return new(a||t)(e.LFG(r.vgb))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var l=o(6104),s=o(9338),T=o(5030),U=o(8746),v=o(4004),G=o(8505),C=o(4115),O=o(9752),R=o(2857),B=o(939),N=o(672);function x(t,c){if(1&t&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,null!=n.selected&&n.selected.id?"AbpTenantManagement::Edit":"AbpTenantManagement::NewTenant")," ")}}function Y(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"form",12),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e._UZ(1,"abp-extensible-form",13),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("formGroup",n.tenantForm)("validateOnSubmit",!0),e.xp6(1),e.Q6J("selectedRecord",n.selected)}}function Z(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"button",14),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",15),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()}if(2&t){const n=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,3,"AbpTenantManagement::Cancel")," "),e.xp6(2),e.Q6J("disabled",null==n.tenantForm?null:n.tenantForm.invalid),e.xp6(1),e.Oqu(e.lcZ(5,5,"AbpTenantManagement::Save"))}}function V(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"abp-feature-management",16),e.NdJ("visibleChange",function(i){e.CHM(n);const m=e.oxw();return e.KtG(m.visibleFeatures=i)}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("visible",n.visibleFeatures)("providerKey",n.providerKey)}}const J=function(){return[]},w=function(){return{value:"T"}},K=function(t){return{value:t}},z=function(t){return{value:t,twoWay:!0}},Q=function(t,c,n){return{providerName:t,providerKey:c,visible:n}},q=function(t){return{visibleChange:t}},j=function(t,c,n){return{inputs:t,outputs:c,componentKey:n}};let u=(()=>{class t{get hasSelectedTenant(){return!!this.selected.id}constructor(n,a,i,m,p,b){this.list=n,this.injector=a,this.confirmationService=i,this.service=m,this.toasterService=p,this.fb=b,this.data={items:[],totalCount:0},this.visibleFeatures=!1,this.modalBusy=!1,this.featureManagementKey="FeatureManagement.FeatureManagementComponent",this.onVisibleFeaturesChange=d=>{this.visibleFeatures=d}}ngOnInit(){this.hookToQuery()}createTenantForm(){const n=new s.lg(this.injector,this.selected);this.tenantForm=(0,s.se)(n)}addTenant(){this.selected={},this.createTenantForm(),this.isModalVisible=!0}editTenant(n){this.service.get(n).subscribe(a=>{this.selected=a,this.createTenantForm(),this.isModalVisible=!0})}save(){if(!this.tenantForm.valid||this.modalBusy)return;this.modalBusy=!0;const{id:n}=this.selected;(n?this.service.update(n,{...this.selected,...this.tenantForm.value}):this.service.create(this.tenantForm.value)).pipe((0,U.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.list.get()})}delete(n,a){this.confirmationService.warn("AbpTenantManagement::TenantDeletionConfirmationMessage","AbpTenantManagement::AreYouSure",{messageLocalizationParams:[a]}).subscribe(i=>{i===l.Tv.Status.confirm&&(this.toasterService.success("AbpUi::SuccessfullyDeleted"),this.service.delete(n).subscribe(()=>this.list.get()))})}hookToQuery(){this.list.hookToQuery(n=>this.service.getList(n)).subscribe(n=>{this.data=n})}onSharedDatabaseChange(n){n||setTimeout(()=>{const a=document.getElementById("defaultConnectionString");a&&a.focus()},0)}openFeaturesModal(n){this.providerKey=n,setTimeout(()=>{this.visibleFeatures=!0},0)}sort(n){const{prop:a,dir:i}=n.sorts[0];this.list.sortKey=a,this.list.sortOrder=i}static#e=this.\u0275fac=function(a){return new(a||t)(e.Y36(r.XNV),e.Y36(e.zs3),e.Y36(l.YP),e.Y36(L),e.Y36(l.MJ),e.Y36(T.QS))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["abp-tenants"]],features:[e._Bn([r.XNV,{provide:s.ex,useValue:"TenantManagement.TenantsComponent"}])],decls:17,vars:30,consts:[[3,"title","toolbar"],["id","wrapper",1,"card"],[1,"card-body"],["id","data-tables-table-filter",1,"data-tables-filter","mb-3"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[3,"data","recordsTotal","list"],[3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],["providerName","T",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[3,"formGroup","validateOnSubmit","ngSubmit"],[3,"selectedRecord"],["abpClose","","type","button",1,"btn","btn-secondary"],["iconClass","fa fa-check",3,"disabled","click"],["providerName","T",3,"visible","providerKey","visibleChange"]],template:function(a,i){1&a&&(e.TgZ(0,"abp-page",0),e.ALo(1,"abpLocalization"),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"input",5),e.NdJ("ngModelChange",function(p){return i.list.filter=p}),e.ALo(7,"abpLocalization"),e.qZA()()(),e._UZ(8,"abp-extensible-table",6),e.qZA()(),e.TgZ(9,"abp-modal",7),e.NdJ("visibleChange",function(p){return i.isModalVisible=p}),e.YNc(10,x,3,3,"ng-template",null,8,e.W1O),e.YNc(12,Y,2,3,"ng-template",null,9,e.W1O),e.YNc(14,Z,6,7,"ng-template",null,10,e.W1O),e.qZA(),e.YNc(16,V,1,2,"abp-feature-management",11),e.qZA()),2&a&&(e.Q6J("title",e.lcZ(1,10,"AbpTenantManagement::Tenants"))("toolbar",i.data.items),e.xp6(6),e.Q6J("placeholder",e.lcZ(7,12,"AbpUi::PagerSearch"))("ngModel",i.list.filter),e.xp6(2),e.Q6J("data",i.data.items||e.DdM(14,J))("recordsTotal",i.data.totalCount||0)("list",i.list),e.xp6(1),e.Q6J("visible",i.isModalVisible)("busy",i.modalBusy),e.xp6(7),e.Q6J("abpReplaceableTemplate",e.kEZ(26,j,e.kEZ(20,Q,e.DdM(15,w),e.VKq(16,K,i.providerKey),e.VKq(18,z,i.visibleFeatures)),e.VKq(24,q,i.onVisibleFeaturesChange),i.featureManagementKey)))},dependencies:[C.hL,T._Y,T.Fj,T.JJ,T.JL,T.On,T.sg,r.YzZ,r.zLP,l.r0,l.zS,l.YM,O.$,s.gt,s.m5,R.II,r.fuE],encapsulation:2})}return t})();const $=s.uk.createMany([{text:"AbpTenantManagement::Edit",action:t=>{t.getInjected(u).editTenant(t.record.id)},permission:"AbpTenantManagement.Tenants.Update"},{text:"AbpTenantManagement::Permission:ManageFeatures",action:t=>{t.getInjected(u).openFeaturesModal(t.record.id)},permission:"AbpTenantManagement.Tenants.ManageFeatures"},{text:"AbpTenantManagement::Delete",action:t=>{t.getInjected(u).delete(t.record.id,t.record.name)},permission:"AbpTenantManagement.Tenants.Delete"}]),H=s.QC.createMany([{type:"string",name:"name",displayName:"AbpTenantManagement::TenantName",sortable:!0}]),y=s.Od.createMany([{type:"string",name:"name",id:"name",displayName:"AbpTenantManagement::TenantName",validators:()=>[T.Validators.required,T.Validators.maxLength(256)]},{type:"email",name:"adminEmailAddress",displayName:"AbpTenantManagement::DisplayName:AdminEmailAddress",id:"admin-email-address",validators:()=>[T.Validators.required,T.Validators.maxLength(256),T.Validators.email]},{type:"passwordinputgroup",name:"adminPassword",displayName:"AbpTenantManagement::DisplayName:AdminPassword",id:"admin-password",autocomplete:"new-password",validators:t=>[T.Validators.required,...(0,l.dD)({get:t.getInjected})]}]),X=y.slice(0,1),k=s.JE.createMany([{text:"AbpTenantManagement::NewTenant",action:t=>{t.getInjected(u).addTenant()},permission:"AbpTenantManagement.Tenants.Create",icon:"fa fa-plus"}]),S={"TenantManagement.TenantsComponent":$},F={"TenantManagement.TenantsComponent":k},P={"TenantManagement.TenantsComponent":H},I={"TenantManagement.TenantsComponent":y},D={"TenantManagement.TenantsComponent":X},A=new e.OlP("TENANT_MANAGEMENT_ENTITY_ACTION_CONTRIBUTORS"),_=new e.OlP("TENANT_MANAGEMENT_TOOLBAR_ACTION_CONTRIBUTORS"),g=new e.OlP("TENANT_MANAGEMENT_ENTITY_PROP_CONTRIBUTORS"),h=new e.OlP("TENANT_MANAGEMENT_CREATE_FORM_PROP_CONTRIBUTORS"),M=new e.OlP("TENANT_MANAGEMENT_EDIT_FORM_PROP_CONTRIBUTORS");let E=(()=>{class t{constructor(){this.configState=(0,e.f3M)(r.XJE),this.extensions=(0,e.f3M)(s.X6)}canActivate(){const n={optional:!0},a=(0,e.f3M)(A,n)||{},i=(0,e.f3M)(_,n)||{},m=(0,e.f3M)(g,n)||{},p=(0,e.f3M)(h,n)||{},b=(0,e.f3M)(M,n)||{};return(0,s.ot)(this.configState,"TenantManagement").pipe((0,v.U)(d=>({"TenantManagement.TenantsComponent":d.Tenant})),(0,s.V_)(this.configState,"TenantManagement"),(0,G.b)(d=>{(0,s.Fr)(this.extensions.entityActions,S,a),(0,s.Fr)(this.extensions.toolbarActions,F,i),(0,s.Hp)(this.extensions.entityProps,P,d.prop,m),(0,s.Hp)(this.extensions.createFormProps,I,d.createForm,p),(0,s.Hp)(this.extensions.editFormProps,D,d.editForm,b)}),(0,v.U)(()=>!0))}static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac})}return t})();const W=[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"",component:r.O39,canActivate:(0,N.BJ)([r.a1M,r.nG9,E]),children:[{path:"tenants",component:r.c$y,data:{requiredPolicy:"AbpTenantManagement.Tenants",replaceableComponent:{key:"TenantManagement.TenantsComponent",defaultComponent:u}}}]}];let ee=(()=>{class t{static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[N.Bz.forChild(W),N.Bz]})}return t})(),te=(()=>{class t{static forChild(n={}){return{ngModule:t,providers:[{provide:A,useValue:n.entityActionContributors},{provide:_,useValue:n.toolbarActionContributors},{provide:g,useValue:n.entityPropContributors},{provide:h,useValue:n.createFormPropContributors},{provide:M,useValue:n.editFormPropContributors},E]}}static forLazy(n={}){return new r.Cgl(t.forChild(n))}static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[ee,C.h2,r.IR2,l.e2,B.XC,O.XE,s.Ms,R.BG]})}return t})()}}]);